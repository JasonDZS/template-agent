# 智能鞋垫V1.2产品需求文档(PRD)

**版本**：V1.2.0  
**创建日期**：2025年7月26日  
**最后更新**：2025年7月28日  
**产品经理**：李小明  
**审核人**：陈晨  

---

## 1. 需求背景

### 1.1 用户反馈分析
根据过去30天的用户反馈统计：
- **数据丢失问题**：占总投诉的32%，主要集中在网络不稳定场景
- **健康监测需求**：28%的用户希望增加心血管健康相关功能
- **界面体验优化**：15%的用户反馈当前异常提醒过于突兀

### 1.2 竞品分析
- 小米手环6：已支持心率异常提醒，但准确率一般
- Apple Watch：心率监测精准，但价格昂贵
- 华为GT3：数据同步稳定性较好

### 1.3 业务目标
- 提升用户留存率3-5%
- 降低因数据丢失导致的客诉率50%
- 增加用户对健康功能的使用频次

---

## 2. 功能需求

### 2.1 异常心率报警功能

**功能描述**：实时监测用户心率，当检测到异常时及时提醒用户

**详细需求**：
- **触发条件**：
  - 静息状态下心率>100bpm或<50bpm
  - 运动状态下心率>180bpm
  - 心率突变幅度>50bpm/分钟
- **报警方式**：
  - 应用内卡片式提醒（橙色背景）
  - 可选推送通知（默认开启）
  - 设备震动提醒
- **误报控制**：
  - 结合运动状态判断
  - 15秒内连续异常才触发报警
  - 同类型报警30分钟内最多提醒1次

**技术实现要点**：
```
if (心率异常 && 持续时间>15s && 距离上次报警>30min) {
    if (运动状态 == 静止 && 心率>100) {
        触发报警("静息心率过高");
    } else if (运动状态 == 跑步 && 心率>180) {
        触发报警("运动心率过高");
    }
}
```

### 2.2 数据上传稳定性优化

**功能描述**：解决网络不稳定环境下的数据丢失问题

**技术方案**：
- **断点续传机制**：
  - 数据分块上传（每块最大100KB）
  - 支持上传中断后自动重试
  - 本地缓存未上传数据最多7天
- **网络状态适配**：
  - WiFi环境：批量上传
  - 4G/5G环境：实时上传
  - 2G/3G环境：延迟上传，等待更好网络
- **错误重试策略**：
  - 指数退避重试：1s、2s、4s、8s、16s
  - 最大重试次数：5次
  - 超时时间：30秒

### 2.3 心率间歇率指标

**功能描述**：新增心率间歇率（HRV）指标，帮助用户了解心血管健康状态

**指标定义**：
- **计算方法**：相邻心跳间隔的标准差
- **正常范围**：5-15ms
- **异常标准**：>20ms或<3ms
- **更新频率**：每分钟计算一次

**界面设计**：
- 在健康分析页面新增HRV卡片
- 显示当前值、1小时趋势图、健康建议
- 首次进入显示功能说明弹窗

### 2.4 UI交互优化

**异常提醒改版**：
- 从弹窗改为页面顶部滑入的卡片
- 颜色从红色改为橙色（#FF8C00）
- 增加图标和文字说明，支持色盲用户

**设备页面简化**：
- 主要指标：当前心率、步数、电量
- 次要信息可点击"查看更多"展开
- 减少信息密度，提升可读性

---

## 3. 非功能需求

### 3.1 性能要求
- 心率异常检测延迟<5秒
- HRV计算不影响设备续航
- 数据上传成功率>95%
- 应用启动时间增长<500ms

### 3.2 兼容性要求
- iOS 12.0+，Android 8.0+
- 支持iPhone 8以上，主流Android设备
- 蓝牙4.0+设备兼容

### 3.3 安全性要求
- 健康数据本地加密存储
- 数据传输使用HTTPS
- 用户隐私数据不上传第三方

---

## 4. 数据埋点

### 4.1 功能使用统计
- `hrv_view_count`：HRV指标查看次数
- `heart_alert_trigger`：心率报警触发次数
- `upload_retry_count`：数据上传重试次数
- `ui_interaction_heatmap`：新UI界面点击热点

### 4.2 性能监控
- `upload_success_rate`：数据上传成功率
- `heart_detection_latency`：心率异常检测延迟
- `battery_consumption`：新功能电量消耗

---

## 5. 验收标准

### 5.1 功能验收
- [ ] 心率异常能正确识别并及时报警
- [ ] 数据上传在弱网环境下不丢失
- [ ] HRV指标计算准确，界面显示正常
- [ ] 新UI符合设计稿，支持色盲用户

### 5.2 性能验收
- [ ] 误报率<5%
- [ ] 数据上传成功率>95%
- [ ] 应用响应速度无明显下降
- [ ] 设备续航影响<10%

### 5.3 兼容性验收
- [ ] 主流设备型号正常运行
- [ ] 不同网络环境下功能正常
- [ ] 新老版本数据兼容

---

## 6. 风险评估

### 6.1 技术风险
- **风险**：心率算法优化可能影响准确性
- **应对**：保留旧算法作为fallback，灰度发布新算法

### 6.2 时间风险
- **风险**：断点续传开发复杂度可能超预期
- **应对**：先实现基础版本，复杂优化后续迭代

### 6.3 用户体验风险
- **风险**：新功能可能增加学习成本
- **应对**：增加新手引导，逐步释放功能

---

## 7. 发布计划

### 7.1 开发排期
- 7/29：需求评审，技术方案确认
- 8/1：算法优化完成
- 8/2：UI设计稿完成
- 8/3：开发完成，提交测试
- 8/4：测试完成，发布准备
- 8/5：正式发布V1.2版本

### 7.2 灰度发布
- 第1天：5%用户（内测用户为主）
- 第3天：20%用户
- 第7天：50%用户
- 第14天：100%用户全量发布

### 7.3 监控指标
- 发布后24小时内crash率<0.1%
- 用户反馈评分不低于4.2分
- 关键功能使用率达到预期目标

---

**附件**：
- UI设计稿：design_v1.2_mockup.figma
- 技术架构图：tech_architecture_v1.2.png
- 测试用例：test_cases_v1.2.xlsx
